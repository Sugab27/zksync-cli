version: '3.2'

services:
  zksync:
    build:
      dockerfile_inline: |
        FROM alpine:latest as downloader
        WORKDIR /download
        RUN apk add --no-cache curl tar
        RUN curl -LO https://github.com/matter-labs/era-test-node/releases/download/v0.1.0-alpha.3/era_test_node-v0.1.0-alpha.3-x86_64-unknown-linux-gnu.tar.gz
        RUN tar -xzf era_test_node-v0.1.0-alpha.3-x86_64-unknown-linux-gnu.tar.gz
        FROM debian:bullseye-slim
        COPY --from=downloader /download/era_test_node /usr/local/bin/
        RUN chmod +x /usr/local/bin/era_test_node
        EXPOSE 8011
        CMD ["era_test_node", "run"]
    ports:
      - "8011:8011"
